{"version":3,"sources":["assets\\src\\scenes\\room\\prepare\\PreparePanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { G } from \"../../../G\";\nimport { PrepareSeatLayout } from \"./PrepareSeatLayout\";\n\nconst {ccclass,property} = cc._decorator;\n\n@ccclass\nexport class PreparePanel extends cc.Component {\n\n    @property(cc.Button)\n    private prepareButton: cc.Button = null;\n    @property(cc.Button)\n    private preparedButton: cc.Button = null;\n    @property(PrepareSeatLayout)\n    private prepareSeatLayout: PrepareSeatLayout = null;\n\n    protected onLoad() {\n        this.addListeners();\n    }\n\n    public show() {\n        this.node.active = true;\n        this.prepareSeatLayout.removeAllUser();\n        let seatMap = G.room.getSeatMap();\n        for(let i in seatMap)  {\n            if(seatMap[i]){\n                this.prepareSeatLayout.addUser(seatMap[i]);\n            }\n        }\n    }\n\n    public hide() {\n        if(this.node.active){\n            this.node.active = false;\n            this.removeListeners();\n        }\n    }\n\n    private onBtnPrepare() {\n        this.prepareButton.node.active = false;\n        this.preparedButton.node.active = true;\n        G.ws.emit(\"ready\");\n    }\n\n    private onWsRoom(room) {\n        G.room.setRoom(room);\n        this.prepareSeatLayout.removeAllUser();\n        let seatMap = G.room.getSeatMap();\n        for(let i in seatMap)  {\n            if(seatMap[i]){\n                this.prepareSeatLayout.addUser(seatMap[i]);\n            }\n        }\n    }\n\n    onWsReady(data) {\n        G.room.setSeatReady(data.seat,true);\n        this.prepareSeatLayout.prepareUser(G.room.getSeatMap()[data.seat].uid)\n    }\n\n    private addListeners() {\n        this.prepareButton.node.on(cc.Node.EventType.TOUCH_END,this.onBtnPrepare,this);\n        G.ws.on(\"room\",this.onWsRoom,this);\n        G.ws.on(\"ready\",this.onWsReady,this);\n        G.ws.on(\"startMe\", this.hide, this);\n        G.ws.on(\"startOther\", this.hide, this);\n    }\n\n    private removeListeners() {\n        G.ws.offTarget(this);\n    }\n}"]}